<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button defaultHref="groups/all"></ion-back-button>
        </ion-buttons>
        <ion-buttons slot="primary">
            <ion-button
                    type="submit"
                    color="primary"
                    expand="block"
                    class="create-button"
                    [disabled]="!groupForm.valid"
                    (click)="groupForm.valid && onSubmit()">
                <ion-icon name="save" slot="icon-only"></ion-icon>
            </ion-button>
        </ion-buttons>
        <ion-title *ngIf="groupId">
            Gruppe bearbeiten
        </ion-title>
        <ion-title *ngIf="!groupId">
            Gruppe erstellen
        </ion-title>
    </ion-toolbar>
</ion-header>

<ion-content padding #content>
    <form [formGroup]="groupForm">
        <ion-list>
            <ion-list-header>
                Details
            </ion-list-header>
            <ion-item>
                <ion-label position="floating">Icon:</ion-label>
                <ion-icon slot="start"
                          *ngIf="groupForm.value"
                          [name]="groupForm.value.icon"></ion-icon>
                <ion-select formControlName="icon">
                    <ion-select-option
                            *ngFor="let option of iconOptions"
                            [value]="option">
                        <ion-icon [name]="option">{{
                            option
                            }}</ion-icon>
                    </ion-select-option>
                </ion-select>
            </ion-item>
            <ion-item>
                <ion-label position="floating">Name</ion-label>
                <ion-input
                        autocomplete="off"
                        type="text"
                        formControlName="name"
                        maxlength="25"
                        placeholder="Beispiel: Deutsch, 6c"
                        autofocus
                        required></ion-input>
            </ion-item>
        </ion-list>
        <ion-list>
            <ion-list-header>
                <ion-label>Mitglieder ({{members.controls?.length}})</ion-label>
            </ion-list-header>
            <ion-item-divider sticky color="none">
                <ion-item lines="none">
                    <ion-label position="stacked">Mitglied hinzuf√ºgen:</ion-label>
                    <ion-input
                        #memberInput
                        placeholder="Beispiel: Amanda"
                        name="newMember"
                        (keyup.enter)="addMember()"
                        [(ngModel)]="newMemberName"
                        [ngModelOptions]="{ standalone: true }"
                        autocomplete="off"></ion-input>
                    <ion-button
                            type="button"
                            (click)="addMember()"
                            slot="end"
                            [disabled]="!addMemberValid()">
                        <ion-icon name="add" slot="icon-only"></ion-icon>
                    </ion-button>
                </ion-item>
            </ion-item-divider>
            <app-missing-data-text
                    [data]="members.controls"
                    text="Keine Mitglieder vorhanden!">
            </app-missing-data-text>
            <app-member
                    [name]="member.value"
                    *ngFor="let member of members.controls; let i = index">
                <ion-button color="danger" (click)="removeMember(member.value)">
                    <ion-icon name="trash" slot="icon-only"></ion-icon>
                </ion-button>
            </app-member>
        </ion-list>
    </form>
</ion-content>
